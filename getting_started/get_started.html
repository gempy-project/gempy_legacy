
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting Started &#8212; GemPy 2.2.8 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GemPy Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Getting Started" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-getting-started-get-started-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="getting-started">
<span id="sphx-glr-getting-started-get-started-py"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing GemPy</span>
<span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>

<span class="c1"># Importing aux libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
</pre></div>
</div>
<div class="section" id="initializing-the-model">
<h2>Initializing the model:<a class="headerlink" href="#initializing-the-model" title="Permalink to this headline">¶</a></h2>
<p>The first step to create a GemPy model is create a gempy.Model object
that will contain all the other data structures and necessary
functionality.</p>
<p>In addition for this example we will define a regular grid since the
beginning. This is the grid where we will interpolate the 3D geological
model. GemPy comes with an array of different grids for different
pourposes as we will see below. For visualization usually a regular grid
is the one that makes more sense.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a> <span class="o">=</span> <a href="../GemPy API/gempy.create_model.html#gempy.create_model" title="gempy.create_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">create_model</span></a><span class="p">(</span><span class="s1">&#39;Model1&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a> <span class="o">=</span> <a href="../GemPy API/gempy.init_data.html#gempy.init_data" title="gempy.init_data" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">init_data</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">791</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">582</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/miguel/miniconda3/envs/gempy/lib/python3.8/site-packages/theano/gpuarray/dnn.py:192: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version &gt;= v5 and &lt;= v7.
  warnings.warn(
Active grids: [&#39;regular&#39;]
</pre></div>
</div>
<p>GemPy core code is written in Python. However for efficiency (and other
reasons) most of heavy computations happend in optimize compile code,
either C or CUDA for GPU. To do so, GemPy rely on the library theano. To
guarantee maximum optimization theano requires to compile the code for
every Python kernel. The compilation is done by calling the following
line at any point (before computing the model):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_compile&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  0
Compilation Done!
Kriging values:
                        values
range              1002.20008
$C_o$            23914.404762
drift equations           [3]

&lt;gempy.core.interpolator.InterpolatorModel object at 0x7fccb8dda370&gt;
</pre></div>
</div>
</div>
<div class="section" id="creating-figure">
<h2>Creating figure:<a class="headerlink" href="#creating-figure" title="Permalink to this headline">¶</a></h2>
<p>GemPy uses matplotlib and pyvista-vtk libraries for 2d and 3d
visualization of the model respectively. One of the design decisions of
GemPy is to allow real time construction of the model. What this means
is that you can start adding input data and see in real time how the 3D
surfaces evolve. Lets initialize the visualization windows.</p>
<p>The first one is the 2d figure. Just place the window where you can see
it (maybe move the jupyter notebook to half screen and use the other
half for the renderers).</p>
<p>%matplotlib qt5</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p2d</span> <span class="o">=</span> <a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_001.png" />
<div class="section" id="add-model-section">
<h3>Add model section<a class="headerlink" href="#add-model-section" title="Permalink to this headline">¶</a></h3>
<p>In the 2d renderer we can add several cross section of the model. In
this case, for simplicity sake we are just adding one perpendicular to
y.</p>
</div>
<div class="section" id="loading-cross-section-image">
<h3>Loading cross-section image:<a class="headerlink" href="#loading-cross-section-image" title="Permalink to this headline">¶</a></h3>
<p>Remember that gempy is simply using matplotlib and therofe the ax object
created above is a standard matplotlib axes. This allow to manipulate it
freely. Lets load an image with the information of couple of boreholes</p>
<p>Reading image</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/image_api.html#matplotlib.image.imread" title="matplotlib.image.imread" class="sphx-glr-backref-module-matplotlib-image sphx-glr-backref-type-py-function"><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span></a><span class="p">(</span><span class="s1">&#39;wells.png&#39;</span><span class="p">)</span>
<span class="c1"># Plotting it inplace</span>
<span class="n">p2d</span> <span class="o">=</span> <a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2d</span><span class="o">.</span><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">791</span><span class="p">,</span> <span class="o">-</span><span class="mi">582</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_002.png" />
<p>We can do the same in 3D through pyvista and vtk rendering:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3d</span> <span class="o">=</span> <a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_003.png" />
<div class="section" id="building-the-model">
<h4>Building the model<a class="headerlink" href="#building-the-model" title="Permalink to this headline">¶</a></h4>
<p>Now that we have everything initialize we can start the construction of
the geological model.</p>
</div>
</div>
</div>
<div class="section" id="surfaces">
<h2>Surfaces<a class="headerlink" href="#surfaces" title="Permalink to this headline">¶</a></h2>
<p>GemPy is a surface based interpolator. This means that all the input
data we add has to be refered to a surface. The surfaces always mark the
bottom of a unit. By default GemPy surfaces are empty:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.surfaces" title="gempy.core.model.ImplicitCoKriging.surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
</style><table id="T_07081_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
        </tbody></table>
</div>
<br />
<br /><p>If we do not care about the names and we just want to interpolate a
surface we can use:</p>
<p>Default surfaces:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_default_surfaces" title="gempy.core.model.ImplicitCoKriging.set_default_surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_default_surfaces</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_6b5fb_row0_col3{
            background-color:  #015482;
        }#T_6b5fb_row1_col3{
            background-color:  #9f0052;
        }</style><table id="T_6b5fb_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_6b5fb_level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_6b5fb_row0_col0" class="data row0 col0" >surface1</td>
                        <td id="T_6b5fb_row0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_6b5fb_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_6b5fb_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_6b5fb_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_6b5fb_level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_6b5fb_row1_col0" class="data row1 col0" >surface2</td>
                        <td id="T_6b5fb_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_6b5fb_row1_col2" class="data row1 col2" >2</td>
                        <td id="T_6b5fb_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_6b5fb_row1_col4" class="data row1 col4" >2</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>Now we can start adding data. GemPy input data consist on surface points
and orientations (perpendicular to the layers). The 2D plot gives you
the X and Z coordinates when hovering the mouse over. We can add a
surface point as follows:</p>
<p>Add a point</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">223</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">94</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface1&#39;</span><span class="p">)</span>

<span class="c1"># Plot in 2D</span>
<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Plot in 3D</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_004.png" />
<img alt="Cell Number: 11 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_005.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/WorkSSD/PythonProjects/gempy/gempy/core/data_modules/geometric_data.py:1368: RuntimeWarning: divide by zero encountered in true_divide
  new_grid_extent = (grid_extent - np.repeat(centers, 2)) / rescaling_factor + 0.5001
/WorkSSD/PythonProjects/gempy/gempy/core/data_modules/geometric_data.py:1369: RuntimeWarning: divide by zero encountered in true_divide
  new_grid_values = (grid_values - centers) / rescaling_factor + 0.5001
/WorkSSD/PythonProjects/gempy/gempy/core/interpolator.py:152: RuntimeWarning: divide by zero encountered in double_scalars
  range_res = range_val / self.additional_data.rescaling_data.df.loc[
/WorkSSD/PythonProjects/gempy/gempy/core/interpolator.py:175: RuntimeWarning: divide by zero encountered in double_scalars
  cov_res = cov_val / self.additional_data.rescaling_data.df.loc[

&lt;gempy.plot.vista.GemPyToVista object at 0x7fccd0e64460&gt;
</pre></div>
</div>
<p>Now we can add the other two points of the layer:</p>
<p>Add points</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">458</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">107</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface1&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">612</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">14</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface1&#39;</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_006.png" />
<img alt="Cell Number: 11 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_007.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc2a5f0e50&gt;
</pre></div>
</div>
<p>The minimum amount of data to interpolate anything in gempy is: a) 2
surface points per surface b) One orientation per series.</p>
<p>Lets add an orientation anywhere in space:</p>
<p>Adding orientation</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_orientations" title="gempy.core.model.ImplicitCoKriging.add_orientations" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_orientations</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">300</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface1&#39;</span><span class="p">,</span> <span class="n">pole_vector</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_008.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_009.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc2a5dc790&gt;
</pre></div>
</div>
<p>Now we have enough data for finally interpolate!</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [2. 2. 2. ... 2. 2. 2.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.additional_data" title="gempy.core.model.ImplicitCoKriging.additional_data" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">additional_data</span><span class="o">.</span><span class="n">kriging_data</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>range</th>
      <td>1002.20008</td>
    </tr>
    <tr>
      <th>$C_o$</th>
      <td>23914.404762</td>
    </tr>
    <tr>
      <th>drift equations</th>
      <td>[3]</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.additional_data" title="gempy.core.model.ImplicitCoKriging.additional_data" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">additional_data</span><span class="o">.</span><span class="n">rescaling_data</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rescaling factor</th>
      <td>778.0</td>
    </tr>
    <tr>
      <th>centers</th>
      <td>[417.5, 0.005, -157.0]</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>That is, we have interpolated the 3D surface. We can visualize:</p>
<p>In 2D</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># In 3D</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_surfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_010.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_011.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc2a5e8700&gt;
</pre></div>
</div>
</div>
<div class="section" id="adding-more-layers">
<h2>Adding more layers:<a class="headerlink" href="#adding-more-layers" title="Permalink to this headline">¶</a></h2>
<p>So far we only need 2 units defined. The cross-section image that we
load have 4 however. Lets add two layers more:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.surfaces" title="gempy.core.model.ImplicitCoKriging.surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_7d16c_row0_col3{
            background-color:  #015482;
        }#T_7d16c_row1_col3{
            background-color:  #9f0052;
        }</style><table id="T_7d16c_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_7d16c_level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_7d16c_row0_col0" class="data row0 col0" >surface1</td>
                        <td id="T_7d16c_row0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_7d16c_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_7d16c_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_7d16c_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_7d16c_level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_7d16c_row1_col0" class="data row1 col0" >surface2</td>
                        <td id="T_7d16c_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_7d16c_row1_col2" class="data row1 col2" >2</td>
                        <td id="T_7d16c_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_7d16c_row1_col4" class="data row1 col4" >2</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.series" title="gempy.core.model.ImplicitCoKriging.series" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">series</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Default series</th>
      <td>1</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surfaces" title="gempy.core.model.ImplicitCoKriging.add_surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surfaces</span></a><span class="p">([</span><span class="s1">&#39;surface3&#39;</span><span class="p">,</span> <span class="s1">&#39;basement&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_e9c6e_row0_col3{
            background-color:  #015482;
        }#T_e9c6e_row1_col3{
            background-color:  #9f0052;
        }#T_e9c6e_row2_col3{
            background-color:  #ffbe00;
        }#T_e9c6e_row3_col3{
            background-color:  #728f02;
        }</style><table id="T_e9c6e_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e9c6e_level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_e9c6e_row0_col0" class="data row0 col0" >surface1</td>
                        <td id="T_e9c6e_row0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_e9c6e_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_e9c6e_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_e9c6e_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_e9c6e_level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_e9c6e_row1_col0" class="data row1 col0" >surface2</td>
                        <td id="T_e9c6e_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_e9c6e_row1_col2" class="data row1 col2" >2</td>
                        <td id="T_e9c6e_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_e9c6e_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_e9c6e_level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_e9c6e_row2_col0" class="data row2 col0" >surface3</td>
                        <td id="T_e9c6e_row2_col1" class="data row2 col1" >Default series</td>
                        <td id="T_e9c6e_row2_col2" class="data row2 col2" >3</td>
                        <td id="T_e9c6e_row2_col3" class="data row2 col3" >#ffbe00</td>
                        <td id="T_e9c6e_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_e9c6e_level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_e9c6e_row3_col0" class="data row3 col0" >basement</td>
                        <td id="T_e9c6e_row3_col1" class="data row3 col1" >Default series</td>
                        <td id="T_e9c6e_row3_col2" class="data row3 col2" >4</td>
                        <td id="T_e9c6e_row3_col3" class="data row3 col3" >#728f02</td>
                        <td id="T_e9c6e_row3_col4" class="data row3 col4" >4</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /></div>
<div class="section" id="layer-2">
<h2>Layer 2<a class="headerlink" href="#layer-2" title="Permalink to this headline">¶</a></h2>
<p>Add the layer next layers:</p>
<p>Your code here:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">269</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface2&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">459</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">279</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface2&#39;</span><span class="p">)</span>

<span class="c1"># --------------------</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>smooth</th>
      <th>surface</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>223.0</td>
      <td>0.01</td>
      <td>-94.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>458.0</td>
      <td>0.00</td>
      <td>-107.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>612.0</td>
      <td>0.00</td>
      <td>-14.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>225.0</td>
      <td>0.00</td>
      <td>-269.0</td>
      <td>0.000001</td>
      <td>surface2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>459.0</td>
      <td>0.00</td>
      <td>-279.0</td>
      <td>0.000001</td>
      <td>surface2</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Compute model</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [4. 4. 4. ... 2. 2. 2.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;force&#39;</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_012.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_013.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc418cb940&gt;
</pre></div>
</div>
</div>
<div class="section" id="layer-3">
<h2>Layer 3<a class="headerlink" href="#layer-3" title="Permalink to this headline">¶</a></h2>
<p>Your code here:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">439</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface3&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">464</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">456</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface3&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">619</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">433</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;surface3&#39;</span><span class="p">)</span>

<span class="c1"># ------------------</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>smooth</th>
      <th>surface</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>223.0</td>
      <td>0.01</td>
      <td>-94.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>458.0</td>
      <td>0.00</td>
      <td>-107.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>612.0</td>
      <td>0.00</td>
      <td>-14.0</td>
      <td>0.000001</td>
      <td>surface1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>225.0</td>
      <td>0.00</td>
      <td>-269.0</td>
      <td>0.000001</td>
      <td>surface2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>459.0</td>
      <td>0.00</td>
      <td>-279.0</td>
      <td>0.000001</td>
      <td>surface2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>225.0</td>
      <td>0.00</td>
      <td>-439.0</td>
      <td>0.000001</td>
      <td>surface3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>464.0</td>
      <td>0.00</td>
      <td>-456.0</td>
      <td>0.000001</td>
      <td>surface3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>619.0</td>
      <td>0.00</td>
      <td>-433.0</td>
      <td>0.000001</td>
      <td>surface3</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Computing and plotting 3D</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>

<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;force&#39;</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">kwargs_plot_structured_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;opacity&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_014.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_015.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcbe0030f70&gt;
</pre></div>
</div>
<p>So far the model is simply a depositional unit. GemPy allows for
unconformities and faults to build complex models. This input is given
by categorical data. In general:</p>
<p>input data (surface points/ orientations) &lt;belong to&lt; surface &lt;belong
to&lt; series</p>
<p>And series can be a fault—i.e. offset the rest of surface— or not. We
are going to show how to add a fault as an example.</p>
<p>First we need to add a series:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_features" title="gempy.core.model.ImplicitCoKriging.add_features" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_features</span></a><span class="p">(</span><span class="s1">&#39;Fault1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Default series</th>
      <td>1</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault1</th>
      <td>2</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.reorder_features" title="gempy.core.model.ImplicitCoKriging.reorder_features" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">reorder_features</span></a><span class="p">([</span><span class="s1">&#39;Fault1&#39;</span><span class="p">,</span> <span class="s1">&#39;Default series&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fault1</th>
      <td>1</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Default series</th>
      <td>2</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Then define that is a fault:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_is_fault" title="gempy.core.model.ImplicitCoKriging.set_is_fault" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_is_fault</span></a><span class="p">(</span><span class="s1">&#39;Fault1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fault colors changed. If you do not like this behavior, set change_color to False.
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fault1</th>
      <td>1</td>
      <td>Fault</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Default series</th>
      <td>2</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>But we also need to add a new surface:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surfaces" title="gempy.core.model.ImplicitCoKriging.add_surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surfaces</span></a><span class="p">(</span><span class="s1">&#39;fault1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_4bd27_row0_col3{
            background-color:  #015482;
        }#T_4bd27_row1_col3{
            background-color:  #9f0052;
        }#T_4bd27_row2_col3{
            background-color:  #ffbe00;
        }#T_4bd27_row3_col3{
            background-color:  #728f02;
        }#T_4bd27_row4_col3{
            background-color:  #443988;
        }</style><table id="T_4bd27_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_4bd27_level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_4bd27_row0_col0" class="data row0 col0" >surface1</td>
                        <td id="T_4bd27_row0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_4bd27_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_4bd27_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_4bd27_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_4bd27_level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_4bd27_row1_col0" class="data row1 col0" >surface2</td>
                        <td id="T_4bd27_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_4bd27_row1_col2" class="data row1 col2" >2</td>
                        <td id="T_4bd27_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_4bd27_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_4bd27_level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_4bd27_row2_col0" class="data row2 col0" >surface3</td>
                        <td id="T_4bd27_row2_col1" class="data row2 col1" >Default series</td>
                        <td id="T_4bd27_row2_col2" class="data row2 col2" >3</td>
                        <td id="T_4bd27_row2_col3" class="data row2 col3" >#ffbe00</td>
                        <td id="T_4bd27_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_4bd27_level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_4bd27_row3_col0" class="data row3 col0" >basement</td>
                        <td id="T_4bd27_row3_col1" class="data row3 col1" >Default series</td>
                        <td id="T_4bd27_row3_col2" class="data row3 col2" >4</td>
                        <td id="T_4bd27_row3_col3" class="data row3 col3" >#728f02</td>
                        <td id="T_4bd27_row3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_4bd27_level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_4bd27_row4_col0" class="data row4 col0" >fault1</td>
                        <td id="T_4bd27_row4_col1" class="data row4 col1" >Default series</td>
                        <td id="T_4bd27_row4_col2" class="data row4 col2" >5</td>
                        <td id="T_4bd27_row4_col3" class="data row4 col3" >#443988</td>
                        <td id="T_4bd27_row4_col4" class="data row4 col4" >5</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>And finally assign the new surface to the new series/fault</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.map_stack_to_surfaces.html#gempy.map_stack_to_surfaces" title="gempy.map_stack_to_surfaces" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Fault1&#39;</span><span class="p">:</span> <span class="s1">&#39;fault1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_38d7f_row0_col3{
            background-color:  #443988;
        }#T_38d7f_row1_col3{
            background-color:  #015482;
        }#T_38d7f_row2_col3{
            background-color:  #9f0052;
        }#T_38d7f_row3_col3{
            background-color:  #ffbe00;
        }#T_38d7f_row4_col3{
            background-color:  #728f02;
        }</style><table id="T_38d7f_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_38d7f_level0_row0" class="row_heading level0 row0" >4</th>
                        <td id="T_38d7f_row0_col0" class="data row0 col0" >fault1</td>
                        <td id="T_38d7f_row0_col1" class="data row0 col1" >Fault1</td>
                        <td id="T_38d7f_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_38d7f_row0_col3" class="data row0 col3" >#443988</td>
                        <td id="T_38d7f_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_38d7f_level0_row1" class="row_heading level0 row1" >0</th>
                        <td id="T_38d7f_row1_col0" class="data row1 col0" >surface1</td>
                        <td id="T_38d7f_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_38d7f_row1_col2" class="data row1 col2" >1</td>
                        <td id="T_38d7f_row1_col3" class="data row1 col3" >#015482</td>
                        <td id="T_38d7f_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_38d7f_level0_row2" class="row_heading level0 row2" >1</th>
                        <td id="T_38d7f_row2_col0" class="data row2 col0" >surface2</td>
                        <td id="T_38d7f_row2_col1" class="data row2 col1" >Default series</td>
                        <td id="T_38d7f_row2_col2" class="data row2 col2" >2</td>
                        <td id="T_38d7f_row2_col3" class="data row2 col3" >#9f0052</td>
                        <td id="T_38d7f_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_38d7f_level0_row3" class="row_heading level0 row3" >2</th>
                        <td id="T_38d7f_row3_col0" class="data row3 col0" >surface3</td>
                        <td id="T_38d7f_row3_col1" class="data row3 col1" >Default series</td>
                        <td id="T_38d7f_row3_col2" class="data row3 col2" >3</td>
                        <td id="T_38d7f_row3_col3" class="data row3 col3" >#ffbe00</td>
                        <td id="T_38d7f_row3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_38d7f_level0_row4" class="row_heading level0 row4" >3</th>
                        <td id="T_38d7f_row4_col0" class="data row4 col0" >basement</td>
                        <td id="T_38d7f_row4_col1" class="data row4 col1" >Default series</td>
                        <td id="T_38d7f_row4_col2" class="data row4 col2" >4</td>
                        <td id="T_38d7f_row4_col3" class="data row4 col3" >#728f02</td>
                        <td id="T_38d7f_row4_col4" class="data row4 col4" >5</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>Now we can just add input data as before (remember the minimum amount of
input data to compute a model):</p>
<p>Add input data of the fault</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;fault1&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points" title="gempy.core.model.ImplicitCoKriging.add_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_points</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">200</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;fault1&#39;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_orientations" title="gempy.core.model.ImplicitCoKriging.add_orientations" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_orientations</span></a><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="s1">&#39;fault1&#39;</span><span class="p">,</span> <span class="n">pole_vector</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Plotting Inpute data</span>
<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_016.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcbe00cdee0&gt;
</pre></div>
</div>
<p>And now is computing as before:</p>
<p>Compute</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>

<span class="c1"># Plot</span>
<a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;force&#39;</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">kwargs_plot_structured_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;opacity&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_017.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_018.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc749edc70&gt;
</pre></div>
</div>
<p>As you can see now instead of having folding layers we have a sharp
jump. Building on this you can pretty much any model you can imagine.</p>
</div>
</div>
<div class="section" id="additional-features">
<h1>Additional features:<a class="headerlink" href="#additional-features" title="Permalink to this headline">¶</a></h1>
<p>Over the years we have built a bunch of assets integrate with gempy.
Here we will show some of them:</p>
<p>GemPy has a built-in capabilities to read and manipulate topographic
data (through gdal). To show an example we can just create a random
topography:</p>
<p>Adding random topography</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_topography" title="gempy.core.model.ImplicitCoKriging.set_topography" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_topography</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">fd</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">d_z</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                         <span class="n">resolution</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">]))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39; &#39;topography&#39;]

Grid Object. Values:
array([[   3.955     ,   10.        , -579.09      ],
       [   3.955     ,   10.        , -573.27      ],
       [   3.955     ,   10.        , -567.45      ],
       ...,
       [ 791.        ,  197.98994975, -117.32042406],
       [ 791.        ,  198.99497487, -115.02473356],
       [ 791.        ,  200.        , -114.7005127 ]])
</pre></div>
</div>
<p>The topography can we visualize in both renderers:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;force&#39;</span><span class="p">)</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">kwargs_plot_structured_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;opacity&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_019.png" />
<img alt="Cell Number: 5 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_020.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcb8bff71f0&gt;
</pre></div>
</div>
<p>But also allows us to compute the geological map of an area:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 16</span>
<a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_topography</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="get started" class="sphx-glr-single-img" src="../_images/sphx_glr_get_started_021.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/WorkSSD/PythonProjects/gempy/gempy/core/solution.py:173: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
  self.geological_map = np.array(

&lt;gempy.plot.vista.GemPyToVista object at 0x7fcc2cff5130&gt;
</pre></div>
</div>
<p>GemPy also allows for inversions (in production only gravity so far). We
can see a small demo how this works.</p>
<p>The first thing to do is to assign densities to each of the units:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_values" title="gempy.core.model.ImplicitCoKriging.add_surface_values" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_values</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_1f6ed_row0_col3{
            background-color:  #443988;
        }#T_1f6ed_row1_col3{
            background-color:  #015482;
        }#T_1f6ed_row2_col3{
            background-color:  #9f0052;
        }#T_1f6ed_row3_col3{
            background-color:  #ffbe00;
        }#T_1f6ed_row4_col3{
            background-color:  #728f02;
        }</style><table id="T_1f6ed_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>        <th class="col_heading level0 col5" >density</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_1f6ed_level0_row0" class="row_heading level0 row0" >4</th>
                        <td id="T_1f6ed_row0_col0" class="data row0 col0" >fault1</td>
                        <td id="T_1f6ed_row0_col1" class="data row0 col1" >Fault1</td>
                        <td id="T_1f6ed_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_1f6ed_row0_col3" class="data row0 col3" >#443988</td>
                        <td id="T_1f6ed_row0_col4" class="data row0 col4" >1</td>
                        <td id="T_1f6ed_row0_col5" class="data row0 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_1f6ed_level0_row1" class="row_heading level0 row1" >0</th>
                        <td id="T_1f6ed_row1_col0" class="data row1 col0" >surface1</td>
                        <td id="T_1f6ed_row1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_1f6ed_row1_col2" class="data row1 col2" >1</td>
                        <td id="T_1f6ed_row1_col3" class="data row1 col3" >#015482</td>
                        <td id="T_1f6ed_row1_col4" class="data row1 col4" >2</td>
                        <td id="T_1f6ed_row1_col5" class="data row1 col5" >2.600000</td>
            </tr>
            <tr>
                        <th id="T_1f6ed_level0_row2" class="row_heading level0 row2" >1</th>
                        <td id="T_1f6ed_row2_col0" class="data row2 col0" >surface2</td>
                        <td id="T_1f6ed_row2_col1" class="data row2 col1" >Default series</td>
                        <td id="T_1f6ed_row2_col2" class="data row2 col2" >2</td>
                        <td id="T_1f6ed_row2_col3" class="data row2 col3" >#9f0052</td>
                        <td id="T_1f6ed_row2_col4" class="data row2 col4" >3</td>
                        <td id="T_1f6ed_row2_col5" class="data row2 col5" >2.400000</td>
            </tr>
            <tr>
                        <th id="T_1f6ed_level0_row3" class="row_heading level0 row3" >2</th>
                        <td id="T_1f6ed_row3_col0" class="data row3 col0" >surface3</td>
                        <td id="T_1f6ed_row3_col1" class="data row3 col1" >Default series</td>
                        <td id="T_1f6ed_row3_col2" class="data row3 col2" >3</td>
                        <td id="T_1f6ed_row3_col3" class="data row3 col3" >#ffbe00</td>
                        <td id="T_1f6ed_row3_col4" class="data row3 col4" >4</td>
                        <td id="T_1f6ed_row3_col5" class="data row3 col5" >3.200000</td>
            </tr>
            <tr>
                        <th id="T_1f6ed_level0_row4" class="row_heading level0 row4" >3</th>
                        <td id="T_1f6ed_row4_col0" class="data row4 col0" >basement</td>
                        <td id="T_1f6ed_row4_col1" class="data row4 col1" >Default series</td>
                        <td id="T_1f6ed_row4_col2" class="data row4 col2" >4</td>
                        <td id="T_1f6ed_row4_col3" class="data row4 col3" >#728f02</td>
                        <td id="T_1f6ed_row4_col4" class="data row4 col4" >5</td>
                        <td id="T_1f6ed_row4_col5" class="data row4 col5" >3.600000</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>Also we can create a centered grid around a device for precision:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_centered_grid" title="gempy.core.model.ImplicitCoKriging.set_centered_grid" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_centered_grid</span></a><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="p">[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39; &#39;topography&#39; &#39;centered&#39;]

Grid Object. Values:
array([[    3.955     ,    10.        ,  -579.09      ],
       [    3.955     ,    10.        ,  -573.27      ],
       [    3.955     ,    10.        ,  -567.45      ],
       ...,
       [ 1200.        ,   800.        ,  -922.71624587],
       [ 1200.        ,   800.        ,  -964.3665184 ],
       [ 1200.        ,   800.        , -1008.        ]])
</pre></div>
</div>
<p>We need to modify the compile code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">],</span> <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_run&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_run
Device:  cpu
Precision:  float64
Number of faults:  1
Compilation Done!
Kriging values:
                        values
range              1002.20008
$C_o$            23914.404762
drift equations        [3, 3]

&lt;gempy.core.interpolator.InterpolatorModel object at 0x7fccb8dda370&gt;
</pre></div>
</div>
<p>But now additionally to the interpolation we also compute the forward
gravity of the model (at the point XYZ = 400, 0, 0)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">fw_gravity</span></a>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([-80.36323225])
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  44.872 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-getting-started-get-started-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/1d91b311984dbbb8e1d2e39bc7cdf8d3/get_started.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">get_started.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9bf70269a429f84375cffc93e1b4648f/get_started.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">get_started.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/./logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cgre-aachen&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/cgre-aachen/gempy">
    <img
        alt="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
        src="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Additional projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-features">Additional features:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">GemPy Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations/index.html">Integrations</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Getting Started</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Getting Started</a></li>
      <li>Next: <a href="../tutorials/index.html" title="next chapter">GemPy Tutorials</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2021, CGRE-Aachen Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/getting_started/get_started.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>