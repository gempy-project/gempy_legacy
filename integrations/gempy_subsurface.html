
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GemPy - Subsurface Link &#8212; GemPy 2.2.8 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code" href="../code.html" />
    <link rel="prev" title="Transform 2019: Integrating Striplog and GemPy" href="gempy_striplog.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-integrations-gempy-subsurface-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="gempy-subsurface-link">
<span id="sphx-glr-integrations-gempy-subsurface-py"></span><h1>GemPy - Subsurface Link<a class="headerlink" href="#gempy-subsurface-link" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pooch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">subsurface</span> <span class="k">as</span> <span class="nn">sb</span>
<span class="kn">from</span> <span class="nn">subsurface.reader</span> <span class="kn">import</span> <span class="n">read_netcdf</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_url</span></a> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/softwareunderground/subsurface/t21-main/examples/tutorials/wells_unstructured.nc&quot;</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_hash</span></a> <span class="o">=</span> <span class="s1">&#39;05198041f2bffcc03d138f7f2b1802657228725c4a895d819d4f5fbc0e9978ca&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">borehole_unstructured_data_file</span></a> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_url</span></a><span class="p">,</span>
                                                 <span class="n">known_hash</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_hash</span></a><span class="p">)</span>

<span class="n">unstruct</span> <span class="o">=</span> <span class="n">read_netcdf</span><span class="o">.</span><span class="n">read_unstruct</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">borehole_unstructured_data_file</span></a><span class="p">)</span>
<span class="n">unstruct</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:       (XYZ: 3, cell: 3283, cell_attr: 1, nodes: 2, points: 3350, vertex_attr: 0)
Coordinates:
  * points        (points) int64 0 1 2 3 4 5 6 ... 3344 3345 3346 3347 3348 3349
  * XYZ           (XYZ) object &#39;X&#39; &#39;Y&#39; &#39;Z&#39;
  * cell_attr     (cell_attr) object &#39;lith_log&#39;
  * vertex_attr   (vertex_attr) int64
    UWI           (cell) object ...
    Depth         (cell) float64 ...
Dimensions without coordinates: cell, nodes
Data variables:
    vertex        (points, XYZ) float64 2.796e+05 3.943e+06 ... -3.33e+03
    cells         (cell, nodes) int64 ...
    cell_attrs    (cell, cell_attr) int64 ...
    vertex_attrs  (points, vertex_attr) float64 ...
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">LineSet</span><span class="p">(</span><span class="n">unstruct</span><span class="p">)</span>
<a href="https://docs.pyvista.org/core/points.html#pyvista.PolyData" title="pyvista.PolyData" class="sphx-glr-backref-module-pyvista sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines_mesh</span></a> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">to_pyvista_line</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Plot default LITH</span>
<span class="n">sb</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">pv_plot</span><span class="p">([</span><a href="https://docs.pyvista.org/core/points.html#pyvista.PolyData" title="pyvista.PolyData" class="sphx-glr-backref-module-pyvista sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines_mesh</span></a><span class="p">])</span>
</pre></div>
</div>
<img alt="gempy subsurface" class="sphx-glr-single-img" src="../_images/sphx_glr_gempy_subsurface_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyvista.plotting.plotting.Plotter object at 0x7fcb8b277250&gt;
</pre></div>
</div>
<div class="section" id="findig-the-boreholes-bases">
<h2>Findig the boreholes bases<a class="headerlink" href="#findig-the-boreholes-bases" title="Permalink to this headline">¶</a></h2>
<p>GemPy interpolates the bottom of a unit, therefore we need to be able to extract those points to be able tointerpolate them.
xarray, pandas and numpy are using the same type of memory representation what makes possible to use the same or at least similar methods to manipulate the data to our will.
Lets find the base points of each well:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating references to the xarray.DataArray</span>
<span class="n">cells_attr</span> <span class="o">=</span> <span class="n">unstruct</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cell_attrs</span>
<span class="n">cells</span> <span class="o">=</span> <span class="n">unstruct</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cells</span>
<span class="n">vertex</span> <span class="o">=</span> <span class="n">unstruct</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">vertex</span>
<span class="c1"># Find vertex points at the boundary of two units</span>
<span class="c1"># Marking each vertex</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bool_prop_change</span></a> <span class="o">=</span> <span class="n">cells_attr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">cells_attr</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># Getting the index of the vertex</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">args_prop_change</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bool_prop_change</span></a><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Getting the attr values at those points</span>
<span class="n">vals_prop_change</span> <span class="o">=</span> <span class="n">cells_attr</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">args_prop_change</span></a><span class="p">]</span>
<span class="n">vals_prop_change</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>cell_attr</th>
      <th>lith_log</th>
    </tr>
    <tr>
      <th>cell</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>590</th>
      <td>8</td>
    </tr>
    <tr>
      <th>591</th>
      <td>9</td>
    </tr>
    <tr>
      <th>592</th>
      <td>10</td>
    </tr>
    <tr>
      <th>593</th>
      <td>11</td>
    </tr>
    <tr>
      <th>594</th>
      <td>13</td>
    </tr>
  </tbody>
</table>
<p>595 rows × 1 columns</p>
</div>
</div>
<br />
<br /><p>Getting the vertex values at those points</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertex_args_prop_change</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">args_prop_change</span></a><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">interface_points</span> <span class="o">=</span> <span class="n">vertex</span><span class="p">[</span><span class="n">vertex_args_prop_change</span><span class="p">]</span>
<span class="n">interface_points</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;vertex&#x27; (cell: 595, XYZ: 3)&gt;
array([[ 2.796350e+05,  3.942877e+06, -1.264778e+03],
       [ 2.796350e+05,  3.942877e+06, -2.227086e+03],
       [ 2.796350e+05,  3.942877e+06, -2.900701e+03],
       ...,
       [ 2.868060e+05,  3.957139e+06, -2.703431e+03],
       [ 2.868060e+05,  3.957139e+06, -2.773010e+03],
       [ 2.868060e+05,  3.957139e+06, -3.120902e+03]])
Coordinates:
    points   (cell) int64 14 24 31 34 36 39 42 ... 3332 3333 3337 3340 3341 3346
  * XYZ      (XYZ) object &#x27;X&#x27; &#x27;Y&#x27; &#x27;Z&#x27;
    UWI      (cell) object Cities_Service_TennecoXX ... DearingerXX
    Depth    (cell) float64 1.299e+03 2.261e+03 ... 2.818e+03 3.166e+03
Dimensions without coordinates: cell</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'vertex'</div><ul class='xr-dim-list'><li><span>cell</span>: 595</li><li><span class='xr-has-index'>XYZ</span>: 3</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0d1b2a41-b3e3-4a97-af00-8b9217b045f0' class='xr-array-in' type='checkbox' checked><label for='section-0d1b2a41-b3e3-4a97-af00-8b9217b045f0' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2.796e+05 3.943e+06 -1.265e+03 ... 2.868e+05 3.957e+06 -3.121e+03</span></div><div class='xr-array-data'><pre>array([[ 2.796350e+05,  3.942877e+06, -1.264778e+03],
       [ 2.796350e+05,  3.942877e+06, -2.227086e+03],
       [ 2.796350e+05,  3.942877e+06, -2.900701e+03],
       ...,
       [ 2.868060e+05,  3.957139e+06, -2.703431e+03],
       [ 2.868060e+05,  3.957139e+06, -2.773010e+03],
       [ 2.868060e+05,  3.957139e+06, -3.120902e+03]])</pre></div></div></li><li class='xr-section-item'><input id='section-a6a4c1ad-9b4b-4cc8-8b3e-a71e6f3d6f16' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a6a4c1ad-9b4b-4cc8-8b3e-a71e6f3d6f16' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>points</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>14 24 31 34 ... 3337 3340 3341 3346</div><input id='attrs-ed95c6a4-6f8d-4933-a753-8f32d36f3761' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ed95c6a4-6f8d-4933-a753-8f32d36f3761' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10666d0e-9ef1-4a13-aafb-1af4c4db1b7b' class='xr-var-data-in' type='checkbox'><label for='data-10666d0e-9ef1-4a13-aafb-1af4c4db1b7b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  14,   24,   31, ..., 3340, 3341, 3346])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>XYZ</span></div><div class='xr-var-dims'>(XYZ)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;X&#x27; &#x27;Y&#x27; &#x27;Z&#x27;</div><input id='attrs-a1460f14-fe2f-4833-b5b5-b70dd70cc104' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a1460f14-fe2f-4833-b5b5-b70dd70cc104' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c903633b-210f-4113-92fc-e242ae93611d' class='xr-var-data-in' type='checkbox'><label for='data-c903633b-210f-4113-92fc-e242ae93611d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>UWI</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e01ed074-4e1d-4aaa-94ef-a9ccbb14b21a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e01ed074-4e1d-4aaa-94ef-a9ccbb14b21a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf0b6602-64b7-4299-9773-bf594961b61f' class='xr-var-data-in' type='checkbox'><label for='data-cf0b6602-64b7-4299-9773-bf594961b61f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([array(&#x27;Cities_Service_TennecoXX&#x27;, dtype=object),
       array(&#x27;Cities_Service_TennecoXX&#x27;, dtype=object),
       array(&#x27;Cities_Service_TennecoXX&#x27;, dtype=object), ...,
       array(&#x27;DearingerXX&#x27;, dtype=object), array(&#x27;DearingerXX&#x27;, dtype=object),
       array(&#x27;DearingerXX&#x27;, dtype=object)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Depth</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8aeb29f6-f858-4fbd-9e3c-f25babe04efc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8aeb29f6-f858-4fbd-9e3c-f25babe04efc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1e5e018-2694-4fe0-86d4-0db5aefb4b24' class='xr-var-data-in' type='checkbox'><label for='data-d1e5e018-2694-4fe0-86d4-0db5aefb4b24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1299.11512 , 2261.422616, 2935.037864, ..., 2748.346442, 2817.924833,
       3165.816788])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b531b3fc-91a0-47cb-8027-e830d19f747b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b531b3fc-91a0-47cb-8027-e830d19f747b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Creating a new UnstructuredData</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">interf_us</span><span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">UnstructuredData</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">vertex</span><span class="o">=</span><span class="n">interface_points</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cells</span><span class="o">=</span><span class="s2">&quot;points&quot;</span><span class="p">,</span>
                                          <span class="n">cells_attr</span><span class="o">=</span><span class="n">vals_prop_change</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
<span class="n">interf_us</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:       (XYZ: 3, cell: 595, cell_attr: 1, nodes: 1, points: 595, vertex_attr: 0)
Coordinates:
  * points        (points) int64 0 1 2 3 4 5 6 7 ... 588 589 590 591 592 593 594
  * XYZ           (XYZ) &lt;U1 &#39;X&#39; &#39;Y&#39; &#39;Z&#39;
  * cell_attr     (cell_attr) object &#39;lith_log&#39;
  * vertex_attr   (vertex_attr) int64
    cell_         (cell) int64 0 1 2 3 4 5 6 7 ... 588 589 590 591 592 593 594
Dimensions without coordinates: cell, nodes
Data variables:
    vertex        (points, XYZ) float64 2.796e+05 3.943e+06 ... -3.121e+03
    cells         (cell, nodes) int64 0 1 2 3 4 5 6 ... 589 590 591 592 593 594
    cell_attrs    (cell, cell_attr) int64 1 2 3 5 8 9 11 13 ... 2 3 8 9 10 11 13
    vertex_attrs  (points, vertex_attr) float64
</pre></div>
</div>
<p>This new UnstructuredData object instead containing data that represent lines, contain point data at the bottom of each
unit. We can plot it very similar as before:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">PointSet</span><span class="p">(</span><span class="n">interf_us</span><span class="p">)</span>
<a href="https://docs.pyvista.org/core/points.html#pyvista.PolyData" title="pyvista.PolyData" class="sphx-glr-backref-module-pyvista sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">point_mesh</span></a> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">to_pyvista_points</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">pv_plot</span><span class="p">([</span><a href="https://docs.pyvista.org/core/points.html#pyvista.PolyData" title="pyvista.PolyData" class="sphx-glr-backref-module-pyvista sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines_mesh</span></a><span class="p">,</span> <a href="https://docs.pyvista.org/core/points.html#pyvista.PolyData" title="pyvista.PolyData" class="sphx-glr-backref-module-pyvista sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">point_mesh</span></a><span class="p">])</span>
</pre></div>
</div>
<img alt="gempy subsurface" class="sphx-glr-single-img" src="../_images/sphx_glr_gempy_subsurface_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyvista.plotting.plotting.Plotter object at 0x7fcc6b77a3a0&gt;
</pre></div>
</div>
</div>
<div class="section" id="gempy-initialize-model">
<h2>GemPy: Initialize model<a class="headerlink" href="#gempy-initialize-model" title="Permalink to this headline">¶</a></h2>
<p>The first step to create a GemPy model is create a gempy.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
<a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a> <span class="o">=</span> <a href="../GemPy API/gempy.create_model.html#gempy.create_model" title="gempy.create_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">create_model</span></a><span class="p">(</span><span class="s2">&quot;getting started&quot;</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_regular_grid" title="gempy.core.model.ImplicitCoKriging.set_regular_grid" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_regular_grid</span></a><span class="p">(</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">275619</span><span class="p">,</span> <span class="mi">323824</span><span class="p">,</span> <span class="mi">3914125</span><span class="p">,</span> <span class="mi">3961793</span><span class="p">,</span> <span class="o">-</span><span class="mf">3972.6</span><span class="p">,</span> <span class="mf">313.922</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_compile&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39;]
Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  0
Compilation Done!
Kriging values:
                        values
range                67928.89
$C_o$            109865107.62
drift equations           [3]

&lt;gempy.core.interpolator.InterpolatorModel object at 0x7fcb84ea4f70&gt;
</pre></div>
</div>
</div>
<div class="section" id="making-a-model-step-by-step">
<h2>Making a model step by step.<a class="headerlink" href="#making-a-model-step-by-step" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The temptation at this point is to bring all the points into gempy and just interpolate. However, often that strategy</span>
<span class="c1"># results in ill posed problems due to noise or irregularities in the data. gempy has been design to being able to</span>
<span class="c1"># iterate rapidly and therefore a much better workflow use to be creating the model step by step.</span>
<span class="c1">#</span>
<span class="c1"># To do that, lets define a function that we can pass the name of the formation and get the assotiated vertex. Grab from</span>
<span class="c1"># the interf_us the XYZ coordinates of the first layer:</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_interface_coord_from_surfaces</span><span class="p">(</span><span class="n">surface_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></a><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">surface_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">surface_names</span><span class="p">):</span>
        <span class="c1"># The properties in subsurface start at 1</span>
        <span class="n">val_property</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">formations</span></a><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">surface_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># Find the cells with the surface id</span>
        <span class="n">args_from_first_surface</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">vals_prop_change</span> <span class="o">==</span> <span class="n">val_property</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">args_from_first_surface</span><span class="p">)</span>
        <span class="c1"># Find the vertex</span>
        <span class="n">points_from_first_surface</span> <span class="o">=</span> <span class="n">interface_points</span><span class="p">[</span><span class="n">args_from_first_surface</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">points_from_first_surface</span><span class="p">)</span>

        <span class="c1"># xarray.DataArray to pandas.DataFrame</span>
        <span class="n">surface_pandas</span> <span class="o">=</span> <span class="n">points_from_first_surface</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

        <span class="c1"># Add formation column</span>
        <span class="n">surface_pandas</span><span class="p">[</span><span class="s2">&quot;surface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_name</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">surface_pandas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="surfaces">
<h3>Surfaces<a class="headerlink" href="#surfaces" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">formations</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;topo&quot;</span><span class="p">,</span> <span class="s2">&quot;etchegoin&quot;</span><span class="p">,</span> <span class="s2">&quot;macoma&quot;</span><span class="p">,</span> <span class="s2">&quot;chanac&quot;</span><span class="p">,</span> <span class="s2">&quot;mclure&quot;</span><span class="p">,</span>
              <span class="s2">&quot;santa_margarita&quot;</span><span class="p">,</span> <span class="s2">&quot;fruitvale&quot;</span><span class="p">,</span>
              <span class="s2">&quot;round_mountain&quot;</span><span class="p">,</span> <span class="s2">&quot;olcese&quot;</span><span class="p">,</span> <span class="s2">&quot;freeman_jewett&quot;</span><span class="p">,</span> <span class="s2">&quot;vedder&quot;</span><span class="p">,</span> <span class="s2">&quot;eocene&quot;</span><span class="p">,</span>
              <span class="s2">&quot;cretaceous&quot;</span><span class="p">,</span>
              <span class="s2">&quot;basement&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_features" title="gempy.core.model.ImplicitCoKriging.add_features" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_features</span></a><span class="p">(</span><span class="s2">&quot;Formations&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_formation_every</span></a> <span class="o">=</span> <span class="mi">3</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surfaces" title="gempy.core.model.ImplicitCoKriging.add_surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">add_surfaces</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">formations</span></a><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_formation_every</span></a><span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_formation_every</span></a><span class="p">])</span>

<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.map_stack_to_surfaces" title="gempy.core.model.ImplicitCoKriging.map_stack_to_surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span></a><span class="p">({</span><span class="s2">&quot;Formations&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;etchegoin&quot;</span><span class="p">,</span> <span class="s2">&quot;macoma&quot;</span><span class="p">,</span> <span class="s2">&quot;chanac&quot;</span><span class="p">,</span> <span class="s2">&quot;mclure&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;Default series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;topo&quot;</span><span class="p">]},</span>
                                <span class="n">set_series</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_344f7_row0_col3{
            background-color:  #015482;
        }#T_344f7_row1_col3{
            background-color:  #9f0052;
        }#T_344f7_row2_col3{
            background-color:  #ffbe00;
        }#T_344f7_row3_col3{
            background-color:  #728f02;
        }</style><table id="T_344f7_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_344f7_level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_344f7_row0_col0" class="data row0 col0" >topo</td>
                        <td id="T_344f7_row0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_344f7_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_344f7_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_344f7_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_344f7_level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_344f7_row1_col0" class="data row1 col0" >chanac</td>
                        <td id="T_344f7_row1_col1" class="data row1 col1" >Formations</td>
                        <td id="T_344f7_row1_col2" class="data row1 col2" >1</td>
                        <td id="T_344f7_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_344f7_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_344f7_level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_344f7_row2_col0" class="data row2 col0" >fruitvale</td>
                        <td id="T_344f7_row2_col1" class="data row2 col1" >Formations</td>
                        <td id="T_344f7_row2_col2" class="data row2 col2" >2</td>
                        <td id="T_344f7_row2_col3" class="data row2 col3" >#ffbe00</td>
                        <td id="T_344f7_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_344f7_level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_344f7_row3_col0" class="data row3 col0" >freeman_jewett</td>
                        <td id="T_344f7_row3_col1" class="data row3 col1" >Formations</td>
                        <td id="T_344f7_row3_col2" class="data row3 col2" >3</td>
                        <td id="T_344f7_row3_col3" class="data row3 col3" >#728f02</td>
                        <td id="T_344f7_row3_col4" class="data row3 col4" >4</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gempy_surface_points</span></a> <span class="o">=</span> <span class="n">get_interface_coord_from_surfaces</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">formations</span></a><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_formation_every</span></a><span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_formation_every</span></a><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surface_points" title="gempy.core.model.ImplicitCoKriging.set_surface_points" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">set_surface_points</span></a><span class="p">(</span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gempy_surface_points</span></a><span class="p">,</span> <span class="n">update_surfaces</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_to_interpolator" title="gempy.core.model.ImplicitCoKriging.update_to_interpolator" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">update_to_interpolator</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-orientations">
<h2>Adding orientations<a class="headerlink" href="#adding-orientations" title="Permalink to this headline">¶</a></h2>
<p>find neighbours</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">neighbours</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">select_nearest_surfaces_points</span><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span></a><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># calculate all fault orientations</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_orientation_from_neighbours_all</span><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">neighbours</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>G_x</th>
      <th>G_y</th>
      <th>G_z</th>
      <th>smooth</th>
      <th>surface</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>279635.0</td>
      <td>3.94e+06</td>
      <td>-1264.78</td>
      <td>3.41e-02</td>
      <td>2.91e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>25</th>
      <td>292056.0</td>
      <td>3.93e+06</td>
      <td>-819.82</td>
      <td>-1.50e-02</td>
      <td>8.02e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>26</th>
      <td>298650.0</td>
      <td>3.95e+06</td>
      <td>-582.32</td>
      <td>-1.14e-01</td>
      <td>-2.74e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>27</th>
      <td>293291.0</td>
      <td>3.93e+06</td>
      <td>-829.70</td>
      <td>-1.06e-01</td>
      <td>-7.89e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>28</th>
      <td>309934.0</td>
      <td>3.95e+06</td>
      <td>-166.96</td>
      <td>-1.83e-02</td>
      <td>1.66e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>29</th>
      <td>304232.0</td>
      <td>3.95e+06</td>
      <td>-298.80</td>
      <td>-2.44e-02</td>
      <td>1.71e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>30</th>
      <td>294111.0</td>
      <td>3.94e+06</td>
      <td>-810.41</td>
      <td>-5.01e-02</td>
      <td>3.98e-05</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>31</th>
      <td>316551.0</td>
      <td>3.93e+06</td>
      <td>-369.52</td>
      <td>-4.08e-02</td>
      <td>-2.75e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>32</th>
      <td>306776.0</td>
      <td>3.94e+06</td>
      <td>-147.06</td>
      <td>3.14e-02</td>
      <td>1.24e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>33</th>
      <td>293771.0</td>
      <td>3.93e+06</td>
      <td>-793.34</td>
      <td>-1.75e-02</td>
      <td>5.89e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>34</th>
      <td>306155.0</td>
      <td>3.95e+06</td>
      <td>-213.33</td>
      <td>1.85e-02</td>
      <td>2.03e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>35</th>
      <td>309582.0</td>
      <td>3.92e+06</td>
      <td>-850.48</td>
      <td>-7.48e-02</td>
      <td>-3.39e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>36</th>
      <td>288972.0</td>
      <td>3.96e+06</td>
      <td>-1013.15</td>
      <td>-1.97e-02</td>
      <td>-1.49e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>37</th>
      <td>286885.0</td>
      <td>3.93e+06</td>
      <td>-1226.40</td>
      <td>-6.22e-02</td>
      <td>-3.43e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>38</th>
      <td>313018.0</td>
      <td>3.93e+06</td>
      <td>-580.29</td>
      <td>-6.06e-02</td>
      <td>-2.91e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>39</th>
      <td>295053.0</td>
      <td>3.93e+06</td>
      <td>-801.37</td>
      <td>-1.12e-01</td>
      <td>4.12e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>40</th>
      <td>318289.0</td>
      <td>3.94e+06</td>
      <td>-306.63</td>
      <td>-1.42e-01</td>
      <td>2.70e-01</td>
      <td>0.95</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>41</th>
      <td>315508.0</td>
      <td>3.92e+06</td>
      <td>-483.49</td>
      <td>-6.15e-02</td>
      <td>-1.91e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>42</th>
      <td>312493.0</td>
      <td>3.92e+06</td>
      <td>-674.47</td>
      <td>-2.44e-01</td>
      <td>1.73e-02</td>
      <td>0.97</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>43</th>
      <td>307338.0</td>
      <td>3.94e+06</td>
      <td>-141.42</td>
      <td>-3.74e-02</td>
      <td>-8.18e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>44</th>
      <td>305670.0</td>
      <td>3.92e+06</td>
      <td>-1057.70</td>
      <td>8.76e-02</td>
      <td>-1.07e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>45</th>
      <td>303406.0</td>
      <td>3.94e+06</td>
      <td>-400.07</td>
      <td>-9.74e-02</td>
      <td>-1.68e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>46</th>
      <td>295971.0</td>
      <td>3.93e+06</td>
      <td>-764.63</td>
      <td>-1.52e-02</td>
      <td>5.36e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>47</th>
      <td>305215.0</td>
      <td>3.92e+06</td>
      <td>-997.36</td>
      <td>8.76e-02</td>
      <td>-1.07e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>48</th>
      <td>289500.0</td>
      <td>3.93e+06</td>
      <td>-1078.63</td>
      <td>-6.33e-02</td>
      <td>2.30e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>49</th>
      <td>302580.0</td>
      <td>3.95e+06</td>
      <td>-292.36</td>
      <td>-2.38e-02</td>
      <td>1.77e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>50</th>
      <td>296417.0</td>
      <td>3.92e+06</td>
      <td>-745.21</td>
      <td>-1.52e-02</td>
      <td>5.36e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>51</th>
      <td>289069.0</td>
      <td>3.93e+06</td>
      <td>-1061.12</td>
      <td>-6.33e-02</td>
      <td>2.30e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>52</th>
      <td>293390.0</td>
      <td>3.93e+06</td>
      <td>-806.01</td>
      <td>-1.75e-02</td>
      <td>5.89e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>53</th>
      <td>293195.0</td>
      <td>3.92e+06</td>
      <td>-711.04</td>
      <td>-6.30e-03</td>
      <td>6.27e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>54</th>
      <td>321527.0</td>
      <td>3.93e+06</td>
      <td>-619.61</td>
      <td>1.05e-01</td>
      <td>1.19e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>55</th>
      <td>320052.0</td>
      <td>3.92e+06</td>
      <td>-240.04</td>
      <td>1.05e-01</td>
      <td>1.19e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>56</th>
      <td>305057.0</td>
      <td>3.93e+06</td>
      <td>-784.11</td>
      <td>-3.18e-02</td>
      <td>-2.99e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>57</th>
      <td>318816.0</td>
      <td>3.93e+06</td>
      <td>-267.32</td>
      <td>-4.21e-02</td>
      <td>-1.89e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>58</th>
      <td>313907.0</td>
      <td>3.93e+06</td>
      <td>-294.88</td>
      <td>-2.98e-02</td>
      <td>-3.41e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>59</th>
      <td>291524.0</td>
      <td>3.93e+06</td>
      <td>-952.16</td>
      <td>-6.29e-02</td>
      <td>1.31e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>60</th>
      <td>284803.0</td>
      <td>3.96e+06</td>
      <td>-1047.24</td>
      <td>-1.37e-02</td>
      <td>-8.01e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>61</th>
      <td>313624.0</td>
      <td>3.92e+06</td>
      <td>-522.03</td>
      <td>-5.62e-02</td>
      <td>-4.87e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>62</th>
      <td>282689.0</td>
      <td>3.96e+06</td>
      <td>-1052.77</td>
      <td>-1.37e-02</td>
      <td>-8.01e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>63</th>
      <td>301819.0</td>
      <td>3.92e+06</td>
      <td>-934.13</td>
      <td>3.19e-02</td>
      <td>2.27e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>64</th>
      <td>324034.0</td>
      <td>3.93e+06</td>
      <td>212.86</td>
      <td>-8.89e-02</td>
      <td>-2.74e-01</td>
      <td>0.96</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>65</th>
      <td>298809.0</td>
      <td>3.95e+06</td>
      <td>-574.95</td>
      <td>-6.99e-02</td>
      <td>-9.51e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>66</th>
      <td>297014.0</td>
      <td>3.94e+06</td>
      <td>-664.61</td>
      <td>-6.20e-02</td>
      <td>-7.26e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>67</th>
      <td>275307.0</td>
      <td>3.95e+06</td>
      <td>-1239.19</td>
      <td>3.41e-02</td>
      <td>2.91e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>68</th>
      <td>311901.0</td>
      <td>3.93e+06</td>
      <td>-481.81</td>
      <td>-2.98e-02</td>
      <td>-3.41e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>69</th>
      <td>305090.0</td>
      <td>3.94e+06</td>
      <td>-234.80</td>
      <td>-9.86e-02</td>
      <td>1.14e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>70</th>
      <td>301307.0</td>
      <td>3.96e+06</td>
      <td>-523.73</td>
      <td>-3.22e-02</td>
      <td>1.77e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>71</th>
      <td>306230.0</td>
      <td>3.92e+06</td>
      <td>-1043.76</td>
      <td>8.76e-02</td>
      <td>-1.07e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>72</th>
      <td>293914.0</td>
      <td>3.93e+06</td>
      <td>-810.55</td>
      <td>-2.34e-02</td>
      <td>7.56e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>73</th>
      <td>278958.0</td>
      <td>3.94e+06</td>
      <td>-1205.68</td>
      <td>3.41e-02</td>
      <td>2.91e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>74</th>
      <td>313989.0</td>
      <td>3.93e+06</td>
      <td>-294.83</td>
      <td>-2.98e-02</td>
      <td>-3.41e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>75</th>
      <td>303412.0</td>
      <td>3.91e+06</td>
      <td>-908.82</td>
      <td>1.03e-01</td>
      <td>-7.10e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>76</th>
      <td>293564.0</td>
      <td>3.93e+06</td>
      <td>-801.74</td>
      <td>-1.75e-02</td>
      <td>5.89e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>77</th>
      <td>301267.0</td>
      <td>3.94e+06</td>
      <td>-457.37</td>
      <td>-2.84e-02</td>
      <td>-1.39e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>78</th>
      <td>303327.0</td>
      <td>3.94e+06</td>
      <td>-376.83</td>
      <td>-9.74e-02</td>
      <td>-1.68e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>79</th>
      <td>321052.0</td>
      <td>3.94e+06</td>
      <td>198.76</td>
      <td>-1.78e-01</td>
      <td>1.43e-02</td>
      <td>0.98</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>80</th>
      <td>306708.0</td>
      <td>3.95e+06</td>
      <td>-259.64</td>
      <td>-1.86e-02</td>
      <td>5.59e-03</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>81</th>
      <td>298595.0</td>
      <td>3.95e+06</td>
      <td>-478.29</td>
      <td>-1.14e-01</td>
      <td>-2.74e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>82</th>
      <td>312908.0</td>
      <td>3.92e+06</td>
      <td>-540.39</td>
      <td>-5.62e-02</td>
      <td>-4.87e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>83</th>
      <td>312252.0</td>
      <td>3.92e+06</td>
      <td>-623.80</td>
      <td>-5.62e-02</td>
      <td>-4.87e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>84</th>
      <td>298335.0</td>
      <td>3.92e+06</td>
      <td>-849.35</td>
      <td>1.33e-02</td>
      <td>-1.75e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>85</th>
      <td>318532.0</td>
      <td>3.93e+06</td>
      <td>-171.11</td>
      <td>1.32e-01</td>
      <td>-1.88e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>86</th>
      <td>307063.0</td>
      <td>3.95e+06</td>
      <td>-234.82</td>
      <td>1.85e-02</td>
      <td>2.03e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>87</th>
      <td>307327.0</td>
      <td>3.94e+06</td>
      <td>-186.74</td>
      <td>8.80e-03</td>
      <td>1.93e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>88</th>
      <td>312385.0</td>
      <td>3.92e+06</td>
      <td>-696.29</td>
      <td>-6.18e-02</td>
      <td>-3.33e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>89</th>
      <td>286806.0</td>
      <td>3.96e+06</td>
      <td>-1033.55</td>
      <td>-1.97e-02</td>
      <td>-1.49e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>topo</td>
    </tr>
    <tr>
      <th>0</th>
      <td>316551.0</td>
      <td>3.93e+06</td>
      <td>-457.85</td>
      <td>-9.30e-02</td>
      <td>-4.45e-02</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>1</th>
      <td>309582.0</td>
      <td>3.92e+06</td>
      <td>-1214.21</td>
      <td>-1.64e-02</td>
      <td>-3.28e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>2</th>
      <td>313018.0</td>
      <td>3.93e+06</td>
      <td>-820.96</td>
      <td>-8.76e-02</td>
      <td>-3.72e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>3</th>
      <td>315508.0</td>
      <td>3.92e+06</td>
      <td>-671.32</td>
      <td>-8.67e-02</td>
      <td>-4.70e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>4</th>
      <td>312493.0</td>
      <td>3.92e+06</td>
      <td>-946.86</td>
      <td>-6.74e-02</td>
      <td>-4.23e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>5</th>
      <td>305670.0</td>
      <td>3.92e+06</td>
      <td>-1707.11</td>
      <td>9.91e-03</td>
      <td>6.43e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>6</th>
      <td>295971.0</td>
      <td>3.93e+06</td>
      <td>-2102.08</td>
      <td>-8.05e-02</td>
      <td>-1.78e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>7</th>
      <td>305215.0</td>
      <td>3.92e+06</td>
      <td>-1714.57</td>
      <td>9.91e-03</td>
      <td>6.43e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>8</th>
      <td>305057.0</td>
      <td>3.93e+06</td>
      <td>-1363.10</td>
      <td>-7.85e-02</td>
      <td>-5.13e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>9</th>
      <td>313907.0</td>
      <td>3.93e+06</td>
      <td>-426.25</td>
      <td>-4.16e-02</td>
      <td>-4.49e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>10</th>
      <td>313624.0</td>
      <td>3.92e+06</td>
      <td>-1012.95</td>
      <td>-4.82e-02</td>
      <td>-1.29e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>11</th>
      <td>324034.0</td>
      <td>3.93e+06</td>
      <td>180.60</td>
      <td>-6.24e-02</td>
      <td>-5.69e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>12</th>
      <td>311901.0</td>
      <td>3.93e+06</td>
      <td>-677.78</td>
      <td>-4.16e-02</td>
      <td>-4.49e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>13</th>
      <td>306230.0</td>
      <td>3.92e+06</td>
      <td>-1750.54</td>
      <td>9.91e-03</td>
      <td>6.43e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>14</th>
      <td>293914.0</td>
      <td>3.93e+06</td>
      <td>-2225.99</td>
      <td>-8.05e-02</td>
      <td>-1.78e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>15</th>
      <td>313989.0</td>
      <td>3.93e+06</td>
      <td>-425.98</td>
      <td>-4.16e-02</td>
      <td>-4.49e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>16</th>
      <td>312908.0</td>
      <td>3.92e+06</td>
      <td>-989.09</td>
      <td>-4.82e-02</td>
      <td>-1.29e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>17</th>
      <td>312252.0</td>
      <td>3.92e+06</td>
      <td>-1145.15</td>
      <td>-4.82e-02</td>
      <td>-1.29e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>18</th>
      <td>312385.0</td>
      <td>3.92e+06</td>
      <td>-1222.39</td>
      <td>-8.27e-02</td>
      <td>-3.63e-02</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>chanac</td>
    </tr>
    <tr>
      <th>19</th>
      <td>305670.0</td>
      <td>3.92e+06</td>
      <td>-2226.64</td>
      <td>-1.61e-01</td>
      <td>1.31e-03</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>fruitvale</td>
    </tr>
    <tr>
      <th>20</th>
      <td>305215.0</td>
      <td>3.92e+06</td>
      <td>-2301.11</td>
      <td>-1.61e-01</td>
      <td>1.31e-03</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>fruitvale</td>
    </tr>
    <tr>
      <th>21</th>
      <td>306230.0</td>
      <td>3.92e+06</td>
      <td>-2136.06</td>
      <td>-1.61e-01</td>
      <td>1.31e-03</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>fruitvale</td>
    </tr>
    <tr>
      <th>22</th>
      <td>303412.0</td>
      <td>3.91e+06</td>
      <td>-2672.53</td>
      <td>-1.76e-01</td>
      <td>-3.57e-02</td>
      <td>0.98</td>
      <td>0.01</td>
      <td>fruitvale</td>
    </tr>
    <tr>
      <th>23</th>
      <td>298335.0</td>
      <td>3.92e+06</td>
      <td>-2387.03</td>
      <td>-9.72e-02</td>
      <td>-1.40e-01</td>
      <td>0.99</td>
      <td>0.01</td>
      <td>fruitvale</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Using the flag to subsurface, the result of the interpolation will get stored in <cite>subsurface</cite> data objects. In the
future exporting to subsurface will be the default behaviour.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">to_subsurface</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [2. 2. 2. ... 4. 4. 4.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3d</span> <span class="o">=</span> <a href="../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="gempy subsurface" class="sphx-glr-single-img" src="../_images/sphx_glr_gempy_subsurface_003.png" />
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">s_regular_grid</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>StructuredData(data=&lt;xarray.Dataset&gt;
Dimensions:              (Features: 2, Properties: 1, X: 50, Y: 50, Z: 50)
Coordinates:
  * Features             (Features) &lt;U14 &#39;Default series&#39; &#39;Formations&#39;
  * Properties           (Properties) &lt;U2 &#39;id&#39;
  * X                    (X) float64 2.761e+05 2.771e+05 ... 3.224e+05 3.233e+05
  * Y                    (Y) float64 3.915e+06 3.916e+06 ... 3.96e+06 3.961e+06
  * Z                    (Z) float64 -3.93e+03 -3.844e+03 ... 185.3 271.1
Data variables:
    property_matrix      (Properties, X, Y, Z) float64 2.0 2.0 2.0 ... 4.0 4.0
    block_matrix         (Features, Properties, X, Y, Z) float64 2.0 2.0 ... 4.0
    scalar_field_matrix  (Features, X, Y, Z) float64 0.8969 0.8986 ... 0.8362
    mask_matrix          (Features, X, Y, Z) bool False False ... True True
    fault_mask           (Features, X, Y, Z) bool False False ... False False, data_array_name=&#39;data_array&#39;)
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">meshes</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:       (XYZ: 3, cell: 27514, cell_attr: 1, nodes: 3, points: 14290, vertex_attr: 0)
Coordinates:
  * points        (points) int64 0 1 2 3 4 5 ... 14285 14286 14287 14288 14289
  * XYZ           (XYZ) &lt;U1 &#39;X&#39; &#39;Y&#39; &#39;Z&#39;
  * cell_attr     (cell_attr) object &#39;id&#39;
  * vertex_attr   (vertex_attr) int64
    cell_         (cell) int64 0 1 2 3 4 5 ... 27509 27510 27511 27512 27513
Dimensions without coordinates: cell, nodes
Data variables:
    vertex        (points, XYZ) float64 2.769e+05 3.915e+06 ... 3.943e+06 271.1
    cells         (cell, nodes) int32 2 1 0 1 3 ... 14212 14289 14219 14215
    cell_attrs    (cell, cell_attr) float64 1.0 1.0 1.0 1.0 ... 3.0 3.0 3.0 3.0
    vertex_attrs  (points, vertex_attr) float64
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  15.762 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-integrations-gempy-subsurface-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3d52f6e2a6899df2513a7d3266187864/gempy_subsurface.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">gempy_subsurface.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9c0f44a7bdd08b37578773a653a1ccb5/gempy_subsurface.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">gempy_subsurface.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/./logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cgre-aachen&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/cgre-aachen/gempy">
    <img
        alt="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
        src="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Additional projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">GemPy Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integrations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gempy_export_MOOSE.html">Export a geological model from GemPy to use in MOOSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="gempy_striplog.html">Transform 2019: Integrating Striplog and GemPy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GemPy - Subsurface Link</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrations</a><ul>
      <li>Previous: <a href="gempy_striplog.html" title="previous chapter">Transform 2019: Integrating Striplog and GemPy</a></li>
      <li>Next: <a href="../code.html" title="next chapter">Code</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2021, CGRE-Aachen Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/integrations/gempy_subsurface.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>